# J. Форматирование документа
<table>
  <tr>
      <td>Ограничение времени</td>
      <td>2 секунды</td>
  </tr>
  <tr>
      <td>Ограничение памяти</td>
      <td>64Mb</td>
  </tr>
  <tr>
      <td>Ввод</td>
      <td>стандартный ввод или input.txt</td>
  </tr>
  <tr>
      <td>Вывод</td>
      <td>стандартный вывод или output.txt</td>
  </tr>
</table>

Вася пишет новую версию своего офисного пакета "Closed Office". Недавно он начал работу над редактором "Dword", входящим в 
состав пакета.  

Последняя проблема, с которой столкнулся Вася — размещение рисунков в документе. Он никак не может добиться стабильного 
отображения рисунков в тех местах, в которые он их помещает. Окончательно отчаявшись написать соответствующий модуль 
самостоятельно, Вася решил обратиться за помощью к вам. Напишите программу, которая будет осуществлять размещение документа 
на странице.  

Документ в формате редактора "Dword" представляет собой последовательность абзацев. Каждый абзац представляет собой 
последовательность элементов – слов и рисунков. Элементы одного абзаца разделены пробелами и/или переводом строки. Абзацы 
разделены пустой строкой. Строка, состоящая только из пробелов, считается пустой.  

Слово — это последовательность символов, состоящая из букв латинского алфавита, цифр, и знаков препинания: ".", ",", ":", ";", 
"!", "?", "-", "'".  

Рисунок описывается следующим образом: "(<b>image</b> image parameters)". Каждый параметр рисунка имеет вид "имя=значение". 
Параметры рисунка разделены пробелами и/или переводом строки. У каждого рисунка обязательно есть следующие параметры:
<table>
  <thead>
    <tr>
      <th align= "left">Параметры</th>
      <th align= "left">Описание</th>
    </tr>
  </thead>
  <tr>
      <td>width</td>
      <td>Целое положительное число – ширина рисунка в пикселях</td>
  </tr>
  <tr>
      <td>height</td>
      <td>Целое положительное число – высота рисунка в пикселях</td>
  </tr>
  <tr>
      <td>layout</td>
      <td>Одно из следующих значений: embedded (в тексте), surrounded (обтекание текстом), floating (свободное) – описывает 
        расположение рисунка относительно текста</td>
  </tr>
</table>

Документ размещается на бесконечной вверх и вниз странице шириной <i>w</i> пикселей (разбиение на конечные по высоте страницы 
планируется в следующей версии редактора). Одна из точек на левой границе страницы условно считается точкой с ординатой 
равной нулю. Ордината увеличивается вниз.  

Размещение документа происходит следующим образом. Абзацы размещаются по очереди. Первый абзац размещается так, что его 
верхняя граница имеет ординату 0.

<div align="center"><img src="./assets/width.png?raw=true" alt="Element width" height="206"/></div>

Абзац размещается следующим образом. Элементы располагаются по строкам. Каждая строка исходно имеет высоту <i>h</i> пикселей. 
В процессе размещения рисунков высота строк может увеличиваться, и строки могут разбиваться рисунками на фрагменты.

<div align="center"><img src="./assets/fragments.png?raw=true" alt="An example of splitting a row into fragments" height="160"/></div>

Слова размещаются следующим образом. Считается, что каждый символ имеет ширину <i>c</i> пикселей. Перед каждым словом, кроме первого 
во фрагменте, ставится пробел шириной также в <i>c</i> пикселей. Если слово помещается в текущем фрагменте, то оно размещается 
на нем. Если слово не помещается в текущем фрагменте, то оно размещается в первом фрагменте текущей строки, расположенном 
правее текущего, в котором оно помещается. Если такого фрагмента нет, то начинается новая строка, и поиск подходящего фрагмента 
продолжается в ней. Слово всегда "прижимается" к верхней границе строки.  

Размещение рисунка зависит от его расположения относительно текста.  

Если расположение рисунка относительно текста установлено в "<i>embedded</i>", то он располагается так же, как слово, за тем 
исключением, что его ширина равна ширине, указанной в параметрах рисунка. Кроме того, если высота рисунка больше текущей 
высоты строки, то она увеличивается до высоты рисунка (при этом верхняя граница строки не перемещается, а смещается вниз 
нижняя граница). Если рисунок типа "<i>embedded</i>" не первый элемент во фрагменте, то перед ним ставится пробел шириной <i>c</i> 
пикселей. Рисунки типа "<i>embedded</i>" также прижимаются к верхней границе строки.  

Если расположение рисунка относительно текста установлено в "<i>surrounded</i>", то рисунок размещается следующим образом. 
Сначала аналогично находится первый фрагмент, в котором рисунок помещается по ширине. При этом перед рисунком этого типа не 
ставится пробел, даже если это не первый элемент во фрагменте.  

После этого рисунок размещается следующим образом: верхний край рисунка совпадает с верхней границей строки, в которой 
находится найденный фрагмент, а сам рисунок продолжается вниз. При этом строки, через которые он проходит, разбиваются им на 
фрагменты.  

Если расположение рисунка относительно текста установлено в "<i>floating</i>", то рисунок размещается поверх текста и других 
рисунков и никак с ними не взаимодействует. В этом случае у рисунка есть два дополнительных параметра: "<i>dx</i>" и 
"<i>dy</i>" — целые числа, задающие смещение в пикселях верхнего левого угла рисунка вправо и вниз, соответственно, 
относительно позиции, где находится верхний правый угол предыдущего слова или рисунка (или самой левой верхней точки первой 
строки абзаца, если рисунок — первый элемент абзаца).  

Если при размещении рисунка таким образом он выходит за левую границу страницы, то он смещается вправо, так, чтобы его левый 
край совпадал с левой границей страницы. Аналогично, если рисунок выходит за правую границу страницы, то он смещается влево, 
чтобы его правый край совпадал с правой границей страницы.  

Верхняя граница следующего абзаца совпадает с более низкой точкой из нижней границы последней строки и самой нижней границы 
рисунков типа "<i>surrounded</i>" предыдущего абзаца.

По заданным <i>w</i>, <i>h</i>, <i>c</i> и документу найдите координаты верхних левых углов всех рисунков в документе.

## Формат ввода
Первая строка входного файла содержит три целых числа: <i>w</i>, <i>h</i> и <i>c</i> (1 ≤ <i>w</i> ≤ 1000, 1 ≤ <i>h</i> ≤ 50, 
1 ≤ <i>c</i> ≤ <i>w</i>).  

Далее следует документ. Размер входного файла не превышает 1000 байт. Гарантируется, что ширина любого слова и любого 
рисунка не превышает <i>w</i>. Высота всех рисунков не превышает 1000. Относительное смещение всех рисунков типа 
"<i>floating</i>" не превышает 1000 по абсолютной величине.

## Формат вывода
Выведите в выходной файл по два числа для каждого рисунка — координаты его верхнего левого угла. Выводите координаты 
рисунков в том порядке, в котором они встречаются во входном файле.

## Пример 1
<table>
  <thead>
    <tr>
      <th align= "left">Ввод</th>
      <th align= "left">Вывод</th>
    </tr>
  </thead>
  <tbody>
    <tr>
        <td>
          120 10 8</br>
          start (image layout=embedded width=12 height=5)</br>
          (image layout=surrounded width=25 height=58)</br>
          and word is</br>
          (image layout=floating dx=18 dy=-15 width=25 height=20)</br>
          here new</br> 
          (image layout=embedded width=20 height=22)</br>
          another</br>
          (image layout=embedded width=40 height=19)</br>
          longword</br>
          </br>
          new paragraph</br>
          (image layout=surrounded width=5 height=30)</br>
          (image layout=floating width=20 height=35 dx=50 dy=-16)</br>
        </td>
        <td>
          48 0</br>
          60 0</br>
          74 -5</br>
          32 20</br>
          0 52</br>
          104 81</br>
          100 65
        </td>
    </tr>
  </tbody>
</table>

## Пример 2
<table>
  <thead>
    <tr>
      <th align= "left">Ввод</th>
      <th align= "left">Вывод</th>
    </tr>
  </thead>
  <tbody>
    <tr>
        <td>1000 2 3</td>
        <td></td>
    </tr>
  </tbody>  
</table>

## Пример 3
<table>
  <thead>
    <tr>
      <th align= "left">Ввод</th>
      <th align= "left">Вывод</th>
    </tr>
  </thead>
  <tbody>
    <tr>
        <td>
          100 2 3</br>
          (image dx=10 dy=11 height=100 width=20 layout=floating)
        </td>
        <td>10 11</td>
    </tr>
  </tbody>
</table>

## Примечания
Ниже приведен рисунок, демонстрирующий расположение изображений в первом примере.

<div align="center"><img src="./assets/example.png?raw=true" alt="Image showing the location of the images in the first example" height="421"/></div>
